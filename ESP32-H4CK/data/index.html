<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32-H4CK Vulnerable Lab</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
        }
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 56px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .navbar-brand {
            font-size: 1.3em;
            font-weight: 700;
            text-decoration: none;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .navbar-nav {
            display: flex;
            align-items: center;
            gap: 6px;
            list-style: none;
        }
        .navbar-nav a {
            color: rgba(255,255,255,0.85);
            text-decoration: none;
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 0.9em;
            transition: background 0.2s, color 0.2s;
        }
        .navbar-nav a:hover, .navbar-nav a.active {
            background: rgba(255,255,255,0.18);
            color: white;
        }
        .navbar-user {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .user-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.15);
            padding: 5px 14px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        .user-badge .role {
            background: rgba(255,255,255,0.25);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8em;
            text-transform: uppercase;
            font-weight: 600;
        }
        .user-badge .role.admin { background: #e74c3c; }
        .btn-nav {
            padding: 6px 16px;
            border-radius: 6px;
            border: 1.5px solid rgba(255,255,255,0.5);
            background: transparent;
            color: white;
            font-size: 0.88em;
            cursor: pointer;
            transition: background 0.2s;
            text-decoration: none;
        }
        .btn-nav:hover { background: rgba(255,255,255,0.18); }
        .btn-nav.solid { background: rgba(255,255,255,0.2); border-color: transparent; }
        .btn-nav.danger { border-color: #e74c3c; color: #ffa0a0; }
        .btn-nav.danger:hover { background: #e74c3c; color: white; }

        .container {
            max-width: 860px;
            margin: 30px auto;
            padding: 0 20px;
        }
        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            padding: 30px;
            margin-bottom: 24px;
        }
        .card-header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid #f0f0f0;
        }
        .card-header h1 { color: #333; font-size: 2.2em; }
        .card-header .version { color: #888; font-size: 0.9em; margin-top: 4px; }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 14px 18px;
            margin-bottom: 24px;
            color: #856404;
            font-size: 0.92em;
            line-height: 1.5;
        }
        .warning strong { display: block; margin-bottom: 4px; }
        h2 { color: #667eea; margin-bottom: 16px; font-size: 1.3em; }
        .endpoint-list { list-style: none; }
        .endpoint-item {
            background: #f8f9fa;
            padding: 14px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            transition: transform 0.15s;
        }
        .endpoint-item:hover { transform: translateX(4px); background: #eef0f5; }
        .endpoint-item a { color: #667eea; text-decoration: none; font-weight: 600; font-size: 1.05em; }
        .endpoint-item p { color: #666; margin-top: 4px; font-size: 0.88em; }
        .method {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            font-weight: 700;
            margin-right: 6px;
            vertical-align: middle;
        }
        .method.get { background: #28a745; color: white; }
        .method.post { background: #007bff; color: white; }
        .btn-group { text-align: center; margin: 24px 0; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
        .btn {
            display: inline-block;
            padding: 10px 22px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95em;
            transition: background 0.2s, transform 0.1s;
        }
        .btn:hover { background: #764ba2; transform: translateY(-1px); }
        .footer {
            text-align: center;
            margin-top: 24px;
            padding-top: 16px;
            border-top: 2px solid #f0f0f0;
            color: #aaa;
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="/" class="navbar-brand">ESP32-H4CK</a>
        <ul class="navbar-nav">
            <li><a href="/" class="active">Home</a></li>
            <li><a href="/shell.html">Shell</a></li>
            <li><a href="/api/info">API</a></li>
        </ul>
        <div class="navbar-user" id="navUser">
            <a href="/login" class="btn-nav solid">Login</a>
        </div>
    </nav>

    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1>ESP32-H4CK</h1>
                <p class="version">Vulnerable Web Application Lab v1.0.0</p>
            </div>

            <div class="warning">
                <strong>Warning - Educational Lab Environment</strong>
                This system contains intentional security vulnerabilities for cybersecurity training and penetration testing education. Deploy ONLY in isolated lab environments.
            </div>

            <h2>Available Endpoints</h2>
            <ul class="endpoint-list">
                <li class="endpoint-item">
                    <span class="method get">GET</span>
                    <a href="/login">/login</a>
                    <p>User authentication page (default: admin/admin, guest/guest)</p>
                </li>
                <li class="endpoint-item">
                    <span class="method get">GET</span>
                    <a href="/admin">/admin</a>
                    <p>Admin panel (requires authentication)</p>
                </li>
                <li class="endpoint-item">
                    <span class="method get">GET</span>
                    <a href="/api/info">/api/info</a>
                    <p>System information and status</p>
                </li>
                <li class="endpoint-item">
                    <span class="method get">GET</span>
                    <a href="/api/users">/api/users</a>
                    <p>User management API (vulnerable to injection)</p>
                </li>
                <li class="endpoint-item">
                    <span class="method get">GET</span>
                    <a href="/shell.html">/shell.html</a>
                    <p>WebSocket-based interactive shell</p>
                </li>
                <li class="endpoint-item">
                    <span class="method get">GET</span>
                    <a href="/debug">/debug</a>
                    <p>Debug information endpoint (info disclosure)</p>
                </li>
                <li class="endpoint-item">
                    <span class="method get">GET</span>
                    <a href="/vuln/comments">/vuln/comments</a>
                    <p>Comment system (vulnerable to XSS)</p>
                </li>
                <li class="endpoint-item">
                    <span class="method get">GET</span>
                    <a href="/vuln/search?q=admin">/vuln/search</a>
                    <p>Search endpoint (vulnerable to SQL injection)</p>
                </li>
            </ul>

            <div class="btn-group">
                <a href="/login" class="btn" id="btnLogin">Login</a>
                <a href="/shell.html" class="btn">Web Shell</a>
                <a href="/api/info" class="btn">System Info</a>
                <a href="/admin" class="btn" id="btnAdmin" style="display:none;">Admin Panel</a>
            </div>

            <h2>Other Services</h2>
            <ul class="endpoint-list">
                <li class="endpoint-item">
                    <strong>Telnet Service:</strong> Port 23
                    <p>Connect with: <code>telnet &lt;device-ip&gt; 23</code></p>
                </li>
                <li class="endpoint-item">
                    <strong>WebSocket Shell:</strong> ws://&lt;device-ip&gt;/shell
                    <p>Interactive command shell via WebSocket</p>
                </li>
            </ul>

            <div class="footer">
                <p>ESP32-H4CK Vulnerable Lab Project - For Educational Use Only</p>
            </div>
        </div>
    </div>

    <script>
        function getCookie(name) {
            var m = document.cookie.match('(^|;)\\s*' + name + '=([^;]*)');
            return m ? decodeURIComponent(m[2]) : null;
        }
        // Sync cookies to localStorage (for browser form login redirect)
        (function() {
            var ct = getCookie('auth_token'), cu = getCookie('auth_user'), cr = getCookie('auth_role');
            if (ct && cu) {
                localStorage.setItem('token', ct);
                localStorage.setItem('username', cu);
                localStorage.setItem('role', cr || 'guest');
            }
        })();
        (function() {
            var token = localStorage.getItem('token');
            var username = localStorage.getItem('username');
            var role = localStorage.getItem('role');
            var nav = document.getElementById('navUser');
            if (token && username) {
                var roleClass = role === 'admin' ? ' admin' : '';
                nav.innerHTML =
                    '<div class="user-badge">' +
                        '<span>' + username + '</span>' +
                        '<span class="role' + roleClass + '">' + role + '</span>' +
                    '</div>' +
                    (role === 'admin' ? '<a href="/admin" class="btn-nav solid">Admin</a>' : '') +
                    '<button class="btn-nav danger" onclick="doLogout()">Logout</button>';
                document.getElementById('btnLogin').style.display = 'none';
                if (role === 'admin') document.getElementById('btnAdmin').style.display = '';
            }
        })();
        function doLogout() {
            fetch('/api/logout').finally(function() {
                localStorage.removeItem('token');
                localStorage.removeItem('username');
                localStorage.removeItem('role');
                window.location.href = '/login';
            });
        }
    </script>
</body>
</html>
